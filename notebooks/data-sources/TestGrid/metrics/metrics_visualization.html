
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>KPI Metrics Visualization &#8212; AI Supported Continuous Integration</title>
    
<<<<<<< HEAD
  <link href="../../../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />
=======
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
>>>>>>> 7e7fb73... Update documentation

    
  <link rel="stylesheet"
    href="../../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

<<<<<<< HEAD
    
      

    
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
=======
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
>>>>>>> 7e7fb73... Update documentation
    <link rel="stylesheet" type="text/css" href="../../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-thebe.css" />
<<<<<<< HEAD
    <link rel="stylesheet" type="text/css" href="../../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/togglebutton.js"></script>
    <script src="../../../../_static/clipboard.min.js"></script>
    <script src="../../../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../../../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
=======
    <link rel="stylesheet" type="text/css" href="../../../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/clipboard.min.js"></script>
    <script src="../../../../_static/copybutton.js"></script>
    <script src="../../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

>>>>>>> 7e7fb73... Update documentation
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<<<<<<< HEAD
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../../index.html">
      
      
=======
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../../index.html">
      
      
      
>>>>>>> 7e7fb73... Update documentation
      <h1 class="site-logo" id="site-title">AI Supported Continuous Integration</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
<<<<<<< HEAD
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../README.html">
   AI4CI : AI for Continuous Integration
  </a>
 </li>
</ul>
<p class="caption">
=======
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../../README.html">
                    AI4CI : AI for Continuous Integration
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
>>>>>>> 7e7fb73... Update documentation
 <span class="caption-text">
  Getting started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../docs/get-started.html">
   Get Started
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../docs/how-to-contribute.html">
   Contribute to the AI for Continuous Integration Project
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../docs/content.html">
   Table of Contents
  </a>
 </li>
</ul>
<<<<<<< HEAD
<p class="caption">
=======
<p aria-level="2" class="caption" role="heading">
>>>>>>> 7e7fb73... Update documentation
 <span class="caption-text">
  Failure type classifier
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../failure-type-classification/README.html">
   Failure type classification with the TestGrid data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../failure-type-classification/testgrid_flakiness_detection.html">
   Flake Detection for TestGrid
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../failure-type-classification/failure_type_classifier.html">
   Failure type classification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../failure-type-classification/failure_type_functions.html">
   Failure type functions
  </a>
 </li>
</ul>
<<<<<<< HEAD
<p class="caption">
=======
<p aria-level="2" class="caption" role="heading">
>>>>>>> 7e7fb73... Update documentation
 <span class="caption-text">
  Time to merge prediction
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../time-to-merge-prediction/README.html">
   Time to Merge Prediction
  </a>
 </li>
<<<<<<< HEAD
 <li class="toctree-l1">
  <a class="reference internal" href="../../../time-to-merge-prediction/time_to_merge_model.html">
   Predicting Time to Merge of a Pull Request
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../time-to-merge-prediction/model_inference.html">
   Time to Merge Prediction Inference Service
  </a>
 </li>
</ul>
<p class="caption">
=======
</ul>
<p aria-level="2" class="caption" role="heading">
>>>>>>> 7e7fb73... Update documentation
 <span class="caption-text">
  Build Log Classifier
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../gcsweb-ci/build-logs/build_log_EDA.html">
   openshift-ci: build logs initial data collection and EDA
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../gcsweb-ci/build-logs/build_log_term_freq.html">
   Term frequency analysis of build logs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../gcsweb-ci/build-logs/model_seldon.html">
   Seldon deployment for build log clustering
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../gcsweb-ci/prow_archive_discovery.html">
   Prow Logs and GCS Data
  </a>
 </li>
</ul>
<<<<<<< HEAD
<p class="caption">
=======
<p aria-level="2" class="caption" role="heading">
>>>>>>> 7e7fb73... Update documentation
 <span class="caption-text">
  TestGrid data
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../testgrid_EDA.html">
   TestGrid: initial EDA and data collection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../testgrid_indepth_EDA.html">
   TestGrid In-Depth EDA
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../testgrid_metadata_EDA.html">
   TestGrid: exploring in-depth metadata
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../background/testgrid_feature_confirmation.html">
   TestGrid Additional Features - uniform or unique?
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="README.html">
   KPI Metrics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="number_of_flakes.html">
     Quantify Flakes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="build_pass_failure.html">
     Quantify Build Pass/Failure
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="correlated_failures.html">
     Correlated test failure sets per test and average size of correlation sets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="blocked_timed_out.html">
     Tests Blocked and Timed Out Tests
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pct_fixed_each_ts.html">
     Percent of Failing Tests Fixed
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="persistent_failures_analysis.html">
     Persistent Failures Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="probability_to_fail.html">
     Probability To Fail
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="test_pass_failures.html">
     Quantify test pass/failures
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="time_to_test.html">
     Quantify Time to Test
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="time_to_fail.html">
     Time to Fail
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="validate_pipeline.html">
     Validate the succesful running of the Automated Pipeline
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="get_raw_data.html">
     Fetch test grid data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="metric_template.html">
     {Metric name}
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="metric_visualization_generic.html">
     KPI Metrics Visualization
    </a>
   </li>
  </ul>
 </li>
</ul>
<<<<<<< HEAD
<p class="caption">
=======
<p aria-level="2" class="caption" role="heading">
>>>>>>> 7e7fb73... Update documentation
 <span class="caption-text">
  Bugzilla Data
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Bugzilla/bugzilla_EDA.html">
   Bugzilla Data for CI Tests on Testgrid
  </a>
 </li>
</ul>
<<<<<<< HEAD
<p class="caption">
 <span class="caption-text">
  Github Repo PR data
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../oc-github-repo/github_PR_EDA.html">
   GitHub Data for OpenShift Origins
  </a>
 </li>
</ul>
<p class="caption">
=======
<p aria-level="2" class="caption" role="heading">
>>>>>>> 7e7fb73... Update documentation
 <span class="caption-text">
  Sippy data
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Sippy/stage/sippy_EDA.html">
   Sippy Export of OpenShift Data - EDA
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Sippy/stage/sippy-analysis.html">
   SIPPY
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Sippy/sippy_failure_correlation.html">
   Initial EDA
  </a>
 </li>
</ul>
<<<<<<< HEAD
<p class="caption">
=======
<p aria-level="2" class="caption" role="heading">
>>>>>>> 7e7fb73... Update documentation
 <span class="caption-text">
  Telemetry data
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Telemetry/telemetry_EDA.html">
   Telemetry Data for CI Clusters
  </a>
 </li>
</ul>
<<<<<<< HEAD

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

=======
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Workshop
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../docs/workshop/prerequisites.html">
   Pre-requisites
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../docs/workshop/intro_to_project.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../docs/workshop/onboarding.html">
   Onboarding
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../docs/workshop/git_setup.html">
   Set up Github environment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../docs/workshop/model_development.html">
   Model Development
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../docs/workshop/ml_pipeline.html">
   Create an ML Pipeline using Elyra and Kubeflow Pipelines
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../docs/workshop/model_deployment.html">
   Model Deployment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../docs/workshop/sql_query_engine.html">
   SQL Query Engine - Trino
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../docs/workshop/visualization_dashboard.html">
   Visualization Dashboard - Superset
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
>>>>>>> 7e7fb73... Update documentation
</div>


          


          
<<<<<<< HEAD
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../../../_sources/notebooks/data-sources/TestGrid/metrics/metrics_visualization.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/aicoe-aiops/ocp-ci-analysis"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/aicoe-aiops/ocp-ci-analysis/issues/new?title=Issue%20on%20page%20%2Fnotebooks/data-sources/TestGrid/metrics/metrics_visualization.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href=" /v2/gh/aicoe-aiops/ocp-ci-analysis/master?urlpath=lab/tree/notebooks/data-sources/TestGrid/metrics/metrics_visualization.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        <a class="jupyterhub-button" href="https://jupyterhub-opf-jupyterhub.apps.smaug.na.operate-first.cloud/hub/user-redirect/git-pull?repo=https://github.com/aicoe-aiops/ocp-ci-analysis&urlpath=lab/tree/ocp-ci-analysis/notebooks/data-sources/TestGrid/metrics/metrics_visualization.ipynb&branch=master"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch JupyterHub" data-toggle="tooltip"
                data-placement="left"><img class="jupyterhub-button-logo"
                    src="../../../../_static/images/logo_jupyterhub.svg"
                    alt="Interact on JupyterHub">JupyterHub</button></a>
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
=======
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href=" /v2/gh/aicoe-aiops/ocp-ci-analysis/master?urlpath=lab/tree/notebooks/data-sources/TestGrid/metrics/metrics_visualization.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://jupyterhub-opf-jupyterhub.apps.smaug.na.operate-first.cloud/hub/user-redirect/git-pull?repo=https%3A//github.com/aicoe-aiops/ocp-ci-analysis&urlpath=lab/tree/ocp-ci-analysis/notebooks/data-sources/TestGrid/metrics/metrics_visualization.ipynb&branch=master"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on JupyterHub"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../../../_static/images/logo_jupyterhub.svg">
  </span>
<span class="headerbtn__text-container">JupyterHub</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/aicoe-aiops/ocp-ci-analysis"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/aicoe-aiops/ocp-ci-analysis/issues/new?title=Issue%20on%20page%20%2Fnotebooks/data-sources/TestGrid/metrics/metrics_visualization.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../../../_sources/notebooks/data-sources/TestGrid/metrics/metrics_visualization.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
>>>>>>> 7e7fb73... Update documentation
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#helper-functions">
   Helper functions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#get-kpi-data">
   Get KPI Data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#get-all-kpis-for-the-selected-dashboard-job-pair">
     Get all KPIs for the selected dashboard, job pair
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#kpis-for-the-selected-dashboard-job">
   KPIs for the selected dashboard, job
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#percent-of-passing-and-failing-tests">
     Percent of passing and failing tests
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#number-of-test-passes">
       Number of Test Passes
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#number-of-test-failures">
       Number of Test Failures
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#test-pass-and-test-failure-percentage">
       Test Pass and Test Failure Percentage
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#persistent-failures">
     Persistent Failures
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#consecutive-failure-rate">
       Consecutive Failure Rate
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#pass-to-fail-rate">
       Pass to Fail Rate
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#fail-to-pass-rate">
       Fail to Pass Rate
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#mean-time-to-fix">
       Mean Time to Fix
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#time-to-test">
     Time to Test
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#average-time-to-test">
       Average Time to Test
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#percent-fixed">
     Percent fixed
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#correlated-failures">
     Correlated failures
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#blocked-timed-out">
     Blocked, Timed out
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#build-pass-failure">
     Build Pass Failure
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#number-of-builds-passed">
       Number of builds passed
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#number-of-builds-failed">
       Number of builds failed
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#number-of-flakes">
     Number of flakes
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#flake-severity">
       Flake Severity
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#visualize-kpis-for-the-different-jobs-under-a-given-dashboard">
   Visualize KPIs for the different jobs under a given dashboard
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#visualize-the-kpis-for-different-tests-under-a-given-job">
   Visualize the KPIs for different tests under a given job
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conclusion">
   Conclusion
  </a>
 </li>
</ul>

<<<<<<< HEAD
            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="kpi-metrics-visualization">
<h1>KPI Metrics Visualization<a class="headerlink" href="#kpi-metrics-visualization" title="Permalink to this headline">¶</a></h1>
=======
    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>KPI Metrics Visualization</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#helper-functions">
   Helper functions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#get-kpi-data">
   Get KPI Data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#get-all-kpis-for-the-selected-dashboard-job-pair">
     Get all KPIs for the selected dashboard, job pair
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#kpis-for-the-selected-dashboard-job">
   KPIs for the selected dashboard, job
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#percent-of-passing-and-failing-tests">
     Percent of passing and failing tests
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#number-of-test-passes">
       Number of Test Passes
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#number-of-test-failures">
       Number of Test Failures
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#test-pass-and-test-failure-percentage">
       Test Pass and Test Failure Percentage
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#persistent-failures">
     Persistent Failures
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#consecutive-failure-rate">
       Consecutive Failure Rate
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#pass-to-fail-rate">
       Pass to Fail Rate
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#fail-to-pass-rate">
       Fail to Pass Rate
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#mean-time-to-fix">
       Mean Time to Fix
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#time-to-test">
     Time to Test
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#average-time-to-test">
       Average Time to Test
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#percent-fixed">
     Percent fixed
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#correlated-failures">
     Correlated failures
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#blocked-timed-out">
     Blocked, Timed out
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#build-pass-failure">
     Build Pass Failure
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#number-of-builds-passed">
       Number of builds passed
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#number-of-builds-failed">
       Number of builds failed
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#number-of-flakes">
     Number of flakes
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#flake-severity">
       Flake Severity
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#visualize-kpis-for-the-different-jobs-under-a-given-dashboard">
   Visualize KPIs for the different jobs under a given dashboard
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#visualize-the-kpis-for-different-tests-under-a-given-job">
   Visualize the KPIs for different tests under a given job
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conclusion">
   Conclusion
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="kpi-metrics-visualization">
<h1>KPI Metrics Visualization<a class="headerlink" href="#kpi-metrics-visualization" title="Permalink to this headline">#</a></h1>
>>>>>>> 7e7fb73... Update documentation
<p>We use key performance indicators, or KPIs, to measure the effectiveness of CI testing processes and understand how to improve them. These KPIs are calculated in notebooks and saved as different metrics. You can see a list of the available metrics and the notebooks that calculate them <a class="reference external" href="https://github.com/aicoe-aiops/ocp-ci-analysis/tree/master/notebooks/data-sources/TestGrid/metrics">here</a>.</p>
<p>Through this notebook, we want to provide a way for users to explore and visualize the available metrics. Although we plan on setting up external tools (such as Apache Superset) for visualization, we also want to provide the option to visualize KPIs in a Jupyter notebook native environment since that is where a lot of data science development happens.</p>
<p>This notebook comprises of these main sections:</p>
<ol class="simple">
<li><p>Fetch and view available data from Ceph bucket</p></li>
<li><p>Create graphs for all the KPIs available, for a selected dashboard and job</p></li>
<li><p>Create graphs for the KPIs at a job level, for a selected dashboard</p></li>
<li><p>Create graphs for all the KPIs at a test level, for a selected dashboard and job</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import required libraries</span>
<span class="kn">import</span> <span class="nn">os</span>
<<<<<<< HEAD
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="k">import</span> <span class="n">tqdm</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">defaultdict</span>
<span class="kn">from</span> <span class="nn">dotenv</span> <span class="k">import</span> <span class="n">load_dotenv</span><span class="p">,</span> <span class="n">find_dotenv</span>

<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="k">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">from</span> <span class="nn">ipynb.fs.defs.metric_template</span> <span class="k">import</span> <span class="n">CephCommunication</span>
=======
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
<span class="kn">from</span> <span class="nn">dotenv</span> <span class="kn">import</span> <span class="n">load_dotenv</span><span class="p">,</span> <span class="n">find_dotenv</span>

<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">from</span> <span class="nn">ipynb.fs.defs.metric_template</span> <span class="kn">import</span> <span class="n">CephCommunication</span>
>>>>>>> 7e7fb73... Update documentation

<span class="n">load_dotenv</span><span class="p">(</span><span class="n">find_dotenv</span><span class="p">())</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">rc</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">)})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Specify variables</span>

<span class="c1">## CEPH Bucket variables</span>
<span class="c1">## Create a .env file on your local with the correct configs</span>
<span class="c1">## Follow this example - https://github.com/aicoe-aiops/ocp-ci-analysis/blob/master/.env-example</span>
<span class="n">s3_endpoint_url</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;S3_ENDPOINT&quot;</span><span class="p">)</span>
<span class="n">s3_access_key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;S3_ACCESS_KEY&quot;</span><span class="p">)</span>
<span class="n">s3_secret_key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;S3_SECRET_KEY&quot;</span><span class="p">)</span>
<span class="n">s3_bucket</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;S3_BUCKET&quot;</span><span class="p">)</span>
<span class="n">s3_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;S3_PROJECT_KEY&quot;</span><span class="p">,</span> <span class="s2">&quot;ai4ci/testgrid/metrics&quot;</span><span class="p">)</span>

<span class="c1"># Specify whether or not we are running this as a notebook or part of an automation pipeline.</span>
<span class="n">AUTOMATION</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;IN_AUTOMATION&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Connect to Ceph</span>

<span class="c1"># ceph connector</span>
<span class="n">cc</span> <span class="o">=</span> <span class="n">CephCommunication</span><span class="p">(</span><span class="n">s3_endpoint_url</span><span class="p">,</span> <span class="n">s3_access_key</span><span class="p">,</span> <span class="n">s3_secret_key</span><span class="p">,</span> <span class="n">s3_bucket</span><span class="p">)</span>

<span class="c1"># bucket where the KPI metrics are stored</span>
<span class="n">metrics_bucket</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">s3_resource</span><span class="o">.</span><span class="n">Bucket</span><span class="p">(</span><span class="n">s3_bucket</span><span class="p">)</span>

<span class="c1"># get all objects (files) corresponding to all metrics</span>
<span class="n">available_kpi_files</span> <span class="o">=</span> <span class="n">metrics_bucket</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Prefix</span><span class="o">=</span><span class="n">s3_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="helper-functions">
<<<<<<< HEAD
<h2>Helper functions<a class="headerlink" href="#helper-functions" title="Permalink to this headline">¶</a></h2>
=======
<h2>Helper functions<a class="headerlink" href="#helper-functions" title="Permalink to this headline">#</a></h2>
>>>>>>> 7e7fb73... Update documentation
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_kpi_data</span><span class="p">(</span>
    <span class="n">date</span><span class="p">,</span> <span class="n">dashboard</span><span class="p">,</span> <span class="n">job</span><span class="p">,</span> <span class="n">kpis_s3_bucket</span><span class="o">=</span><span class="n">metrics_bucket</span><span class="p">,</span> <span class="n">kpis_s3_path</span><span class="o">=</span><span class="n">s3_path</span>
<span class="p">):</span>
    <span class="c1"># get the available parquet filenames</span>
    <span class="n">kpi_files</span> <span class="o">=</span> <span class="n">kpis_s3_bucket</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Prefix</span><span class="o">=</span><span class="n">kpis_s3_path</span><span class="p">)</span>

    <span class="c1"># read parquet file corresponding to each of the kpis</span>
    <span class="n">all_kpis_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">kf</span> <span class="ow">in</span> <span class="n">kpi_files</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">kf</span><span class="o">.</span><span class="n">key</span><span class="p">:</span>
            <span class="n">curr_kpi_df</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">read_from_ceph</span><span class="p">(</span>
                <span class="n">kpis_s3_path</span><span class="p">,</span>
                <span class="n">kf</span><span class="o">.</span><span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="n">maxsplit</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="s2">&quot;grid&quot;</span> <span class="ow">in</span> <span class="n">curr_kpi_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="n">curr_kpi_df</span> <span class="o">=</span> <span class="n">curr_kpi_df</span><span class="p">[</span>
                    <span class="p">(</span><span class="n">curr_kpi_df</span><span class="p">[</span><span class="s2">&quot;tab&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">dashboard</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">curr_kpi_df</span><span class="p">[</span><span class="s2">&quot;grid&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">job</span><span class="p">)</span>
                <span class="p">]</span>
            <span class="k">elif</span> <span class="s2">&quot;job&quot;</span> <span class="ow">in</span> <span class="n">curr_kpi_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="n">curr_kpi_df</span> <span class="o">=</span> <span class="n">curr_kpi_df</span><span class="p">[</span>
                    <span class="p">(</span><span class="n">curr_kpi_df</span><span class="p">[</span><span class="s2">&quot;tab&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">dashboard</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">curr_kpi_df</span><span class="p">[</span><span class="s2">&quot;job&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">job</span><span class="p">)</span>
                <span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span>
<<<<<<< HEAD
                    <span class="n">f</span><span class="s1">&#39;Neither &quot;job&quot; nor &quot;grid&quot; column found in </span><span class="si">{kf.key}</span><span class="s1">. Maybe this df has a different schema. &#39;</span>
                    <span class="n">f</span><span class="s2">&quot;Appending it as-is, without filtering.&quot;</span>
=======
                    <span class="sa">f</span><span class="s1">&#39;Neither &quot;job&quot; nor &quot;grid&quot; column found in </span><span class="si">{</span><span class="n">kf</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s1">. Maybe this df has a different schema. &#39;</span>
                    <span class="sa">f</span><span class="s2">&quot;Appending it as-is, without filtering.&quot;</span>
>>>>>>> 7e7fb73... Update documentation
                <span class="p">)</span>

            <span class="n">is_col_allnans</span> <span class="o">=</span> <span class="n">curr_kpi_df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">curr_kpi_df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span>
<<<<<<< HEAD
                    <span class="n">f</span><span class="s2">&quot;No data found in </span><span class="si">{kf.key}</span><span class="s2"> corresponding to dashboard </span><span class="si">{dashboard}</span><span class="s2"> and job </span><span class="si">{job}</span><span class="s2">. Skipping this df&quot;</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">is_col_allnans</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="n">f</span><span class="s2">&quot;Found columns that were all nans: </span><span class="si">{is_col_allnans[is_col_allnans].index}</span><span class="s2">. Skipping this df&quot;</span>
=======
                    <span class="sa">f</span><span class="s2">&quot;No data found in </span><span class="si">{</span><span class="n">kf</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2"> corresponding to dashboard </span><span class="si">{</span><span class="n">dashboard</span><span class="si">}</span><span class="s2"> and job </span><span class="si">{</span><span class="n">job</span><span class="si">}</span><span class="s2">. Skipping this df&quot;</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">is_col_allnans</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Found columns that were all nans: </span><span class="si">{</span><span class="n">is_col_allnans</span><span class="p">[</span><span class="n">is_col_allnans</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="si">}</span><span class="s2">. Skipping this df&quot;</span>
>>>>>>> 7e7fb73... Update documentation
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">all_kpis_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="n">all_kpis_df</span><span class="p">,</span>
                        <span class="n">curr_kpi_df</span><span class="p">,</span>
                    <span class="p">],</span>
                <span class="p">)</span>

    <span class="k">return</span> <span class="n">all_kpis_df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_grids</span><span class="p">(</span><span class="n">tab</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">metric_name</span><span class="p">,</span> <span class="n">x_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">graph_title</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Takes as an argument the dashboard tab, test name, metric df, the KPI metric, metric unit and</span>
<span class="sd">    the graph title</span>

<span class="sd">    Plots the distribution of KPI values over time for the different jobs(grids)</span>
<span class="sd">    in a given TestGrid dashboard tab</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">grid</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;tab&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">tab</span><span class="p">][</span><span class="s2">&quot;grid&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
        <span class="n">grid_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="n">grid_values</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span>
            <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;tab&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">tab</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;grid&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">grid</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;test&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">test</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="s2">&quot;timestamp&quot;</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="n">metric_name</span><span class="p">,</span>
            <span class="n">data</span><span class="o">=</span><span class="n">grid_values</span><span class="p">,</span>
            <span class="n">legend</span><span class="o">=</span><span class="s2">&quot;brief&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">grid</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">graph_title</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_metrics_tab_grid</span><span class="p">(</span><span class="n">tab</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">metric_name</span><span class="p">,</span> <span class="n">x_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">graph_title</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Takes as an argument the TestGrid dashboard tab, grid(job), metric data frame, the KPI metric name,</span>
<span class="sd">    and the title of the graph</span>

<span class="sd">    Plots the KPI values over time for the particular grid(job) in a given TestGrid dashboard tab</span>
<span class="sd">    Plots change in KPI metrics over time</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;tab&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">tab</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;grid&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">grid</span><span class="p">)]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">rc</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">)})</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;timestamp&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">metric_name</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">graph_title</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_tests</span><span class="p">(</span><span class="n">tab</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">metric_name</span><span class="p">,</span> <span class="n">x_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">graph_title</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Takes as an argument the dashboard tab, grid(job), metric data frame, KPI metric, metric unit and</span>
<span class="sd">    the graph title</span>

<span class="sd">    Plots the distribution of KPI values over time for the different tests in a job(grid) of a given</span>
<span class="sd">    TestGrid dashboard tab</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">test</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;tab&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">tab</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;grid&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">grid</span><span class="p">)][</span><span class="s2">&quot;test&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
        <span class="n">grid_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="n">grid_values</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span>
            <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;tab&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">tab</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;grid&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">grid</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;test&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">test</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="s2">&quot;timestamp&quot;</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="n">metric_name</span><span class="p">,</span>
            <span class="n">data</span><span class="o">=</span><span class="n">grid_values</span><span class="p">,</span>
            <span class="n">legend</span><span class="o">=</span><span class="s2">&quot;brief&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">test</span><span class="p">),</span>
        <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">graph_title</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Function to plot percentages on the bar graph</span>
<span class="k">def</span> <span class="nf">with_hue</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span> <span class="n">feature</span><span class="p">,</span> <span class="n">number_of_categories</span><span class="p">,</span> <span class="n">hue_categories</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">plot</span><span class="o">.</span><span class="n">patches</span><span class="p">]</span>
    <span class="n">patch</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">plot</span><span class="o">.</span><span class="n">patches</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_categories</span><span class="p">):</span>
        <span class="n">total</span> <span class="o">=</span> <span class="n">feature</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">hue_categories</span><span class="p">):</span>
            <span class="n">percentage</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.1f}</span><span class="s2">%&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="mi">100</span> <span class="o">*</span> <span class="n">a</span><span class="p">[(</span><span class="n">j</span> <span class="o">*</span> <span class="n">number_of_categories</span> <span class="o">+</span> <span class="n">i</span><span class="p">)]</span> <span class="o">/</span> <span class="n">total</span>
            <span class="p">)</span>
            <span class="n">x</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">patch</span><span class="p">[(</span><span class="n">j</span> <span class="o">*</span> <span class="n">number_of_categories</span> <span class="o">+</span> <span class="n">i</span><span class="p">)]</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span>
                <span class="o">+</span> <span class="n">patch</span><span class="p">[(</span><span class="n">j</span> <span class="o">*</span> <span class="n">number_of_categories</span> <span class="o">+</span> <span class="n">i</span><span class="p">)]</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span>
                <span class="o">-</span> <span class="mf">0.15</span>
            <span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">patch</span><span class="p">[(</span><span class="n">j</span> <span class="o">*</span> <span class="n">number_of_categories</span> <span class="o">+</span> <span class="n">i</span><span class="p">)]</span><span class="o">.</span><span class="n">get_y</span><span class="p">()</span>
                <span class="o">+</span> <span class="n">patch</span><span class="p">[(</span><span class="n">j</span> <span class="o">*</span> <span class="n">number_of_categories</span> <span class="o">+</span> <span class="n">i</span><span class="p">)]</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span>
            <span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">percentage</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="get-kpi-data">
<<<<<<< HEAD
<h2>Get KPI Data<a class="headerlink" href="#get-kpi-data" title="Permalink to this headline">¶</a></h2>
=======
<h2>Get KPI Data<a class="headerlink" href="#get-kpi-data" title="Permalink to this headline">#</a></h2>
>>>>>>> 7e7fb73... Update documentation
<p>We will connect to Ceph and identify the available KPI parquet files.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># extract the names of unique KPI metric files, and the KPIs available in them</span>
<span class="n">kpis_in_kpifile</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
<span class="n">dates_available_for_kpifile</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>

<span class="c1"># list of available dashboards and jobs for which KPIs are available</span>
<span class="n">available_dashboards</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<span class="n">available_jobs_per_dashboard</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>

<span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">available_kpi_files</span><span class="p">):</span>

    <span class="c1"># NOTE: this file is an inconsistency that resulted from previous experimentation phases</span>
    <span class="c1"># it should ideally be removed from the bucket at some point</span>
    <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;metrics/flake.parquet&quot;</span><span class="p">:</span>
        <span class="k">continue</span>

    <span class="c1"># split key into prefix &quot;directory&quot;, metric name, and filename</span>
    <span class="n">dir_name</span><span class="p">,</span> <span class="n">metric_obj_name</span><span class="p">,</span> <span class="n">file_name</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>

    <span class="c1"># update dictionary if key doesnt exist</span>
    <span class="k">if</span> <span class="n">metric_obj_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kpis_in_kpifile</span><span class="p">:</span>
        <span class="c1"># read a sample file to see what kpis are contained in this file</span>
<<<<<<< HEAD
        <span class="n">sample_file</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">read_from_ceph</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;</span><span class="si">{dir_name}</span><span class="s2">/</span><span class="si">{metric_obj_name}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>
=======
        <span class="n">sample_file</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">read_from_ceph</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dir_name</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">metric_obj_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>
>>>>>>> 7e7fb73... Update documentation

        <span class="k">if</span> <span class="s2">&quot;tab&quot;</span> <span class="ow">in</span> <span class="n">sample_file</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="c1"># what dashboards do we have data for</span>
            <span class="n">curr_df_dashboards</span> <span class="o">=</span> <span class="n">sample_file</span><span class="p">[</span><span class="s2">&quot;tab&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
            <span class="n">available_dashboards</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">curr_df_dashboards</span><span class="p">)</span>

            <span class="c1"># get a mapping of dashboard:jobs from the current file</span>
            <span class="c1"># then update the global dict to make sure we&#39;re not missing anything</span>
            <span class="k">if</span> <span class="s2">&quot;job&quot;</span> <span class="ow">in</span> <span class="n">sample_file</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="n">curr_df_jobs_per_dashboard</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">sample_file</span><span class="p">[[</span><span class="s2">&quot;tab&quot;</span><span class="p">,</span> <span class="s2">&quot;job&quot;</span><span class="p">]]</span>
                    <span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
                    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;tab&quot;</span><span class="p">)</span>
                    <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">set</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">job</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>
                    <span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">curr_df_jobs_per_dashboard</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">available_jobs_per_dashboard</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
            <span class="k">elif</span> <span class="s2">&quot;grid&quot;</span> <span class="ow">in</span> <span class="n">sample_file</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="n">curr_df_jobs_per_dashboard</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">sample_file</span><span class="p">[[</span><span class="s2">&quot;tab&quot;</span><span class="p">,</span> <span class="s2">&quot;grid&quot;</span><span class="p">]]</span>
                    <span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
                    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;tab&quot;</span><span class="p">)</span>
                    <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">set</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>
                    <span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">curr_df_jobs_per_dashboard</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">available_jobs_per_dashboard</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span>
<<<<<<< HEAD
                    <span class="n">f</span><span class="s2">&quot;Neither grid nor job column found in </span><span class="si">{file_name}</span><span class="s2">. Cannot extract job info&quot;</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;tab column not found in </span><span class="si">{file_name}</span><span class="s2">. Cannot extract dashboard info&quot;</span><span class="p">)</span>
=======
                    <span class="sa">f</span><span class="s2">&quot;Neither grid nor job column found in </span><span class="si">{</span><span class="n">file_name</span><span class="si">}</span><span class="s2">. Cannot extract job info&quot;</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;tab column not found in </span><span class="si">{</span><span class="n">file_name</span><span class="si">}</span><span class="s2">. Cannot extract dashboard info&quot;</span><span class="p">)</span>
>>>>>>> 7e7fb73... Update documentation

        <span class="c1"># get these kpis names</span>
        <span class="n">kpis</span> <span class="o">=</span> <span class="n">sample_file</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span>
            <span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">,</span> <span class="s2">&quot;tab&quot;</span><span class="p">,</span> <span class="s2">&quot;job&quot;</span><span class="p">,</span> <span class="s2">&quot;grid&quot;</span><span class="p">,</span> <span class="s2">&quot;test&quot;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span>
        <span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

        <span class="c1"># update mapping of &quot;filename&quot;: &quot;kpi&quot;</span>
        <span class="n">kpis_in_kpifile</span><span class="p">[</span><span class="n">metric_obj_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">kpis</span>

    <span class="c1"># update mapping of &quot;metric name&quot;: &quot;dates for which data is available&quot;</span>
    <span class="n">date</span> <span class="o">=</span> <span class="n">file_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">maxsplit</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">maxsplit</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">dates_available_for_kpifile</span><span class="p">[</span><span class="n">metric_obj_name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">date</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1it [00:00,  3.80it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tab column not found in avg_correlation-2021-4-14.parquet. Cannot extract dashboard info
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>30it [00:02, 18.83it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tab column not found in correlation-2021-4-14.parquet. Cannot extract dashboard info
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>97it [00:44,  2.18it/s]
</pre></div>
</div>
</div>
</div>
<p><strong>NOTE</strong> The following kpi file / metric / date selection process is a bit restricted right now since ipywidgets are currently unavailable, but should be more interactive once that issue is resolved.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Available dashboards to choose from:&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">available_dashboards</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Available dashboards to choose from:

&quot;redhat-openshift-okd-release-4.5-blocking&quot;
&quot;redhat-openshift-ocp-release-4.7-informing&quot;
&quot;redhat-openshift-okd-release-4.4-informing&quot;
&quot;redhat-openshift-okd-release-4.6-informing&quot;
&quot;redhat-openshift-okd-release-4.7-informing&quot;
&quot;redhat-openshift-ocp-release-4.6-blocking&quot;
&quot;redhat-openshift-okd-release-4.8-blocking&quot;
&quot;redhat-openshift-ocp-release-4.3-broken&quot;
&quot;redhat-openshift-ocp-release-4.1-blocking&quot;
&quot;redhat-openshift-ocp-release-4.9-informing&quot;
&quot;redhat-openshift-ocp-release-4.7-blocking&quot;
&quot;redhat-openshift-ocp-release-4.4-blocking&quot;
&quot;redhat-openshift-ocp-release-4.3-blocking&quot;
&quot;redhat-assisted-installer&quot;
&quot;redhat-openshift-ocp-release-4.9-blocking&quot;
&quot;redhat-openshift-ocp-release-4.5-broken&quot;
&quot;redhat-openshift-ocp-release-4.4-informing&quot;
&quot;redhat-openshift-okd-release-4.5-informing&quot;
&quot;redhat-openshift-informing&quot;
&quot;redhat-openshift-ocp-release-4.2-blocking&quot;
&quot;redhat-openshift-okd-release-4.9-informing&quot;
&quot;redhat-single-node&quot;
&quot;redhat-openshift-presubmit-master-gcp&quot;
&quot;redhat-openshift-ocp-release-4.5-blocking&quot;
&quot;redhat-openshift-ocp-release-4.5-informing&quot;
&quot;redhat-openshift-ocp-release-4.3-informing&quot;
&quot;redhat-openshift-ocp-release-4.6-broken&quot;
&quot;redhat-openshift-ocp-release-4.2-informing&quot;
&quot;redhat-openshift-okd-release-4.7-blocking&quot;
&quot;redhat-openshift-okd-release-4.3-informing&quot;
&quot;redhat-openshift-ocp-release-4.6-informing&quot;
&quot;redhat-osd&quot;
&quot;redhat-openshift-ocp-release-4.8-blocking&quot;
&quot;redhat-openshift-ocp-release-4.1-informing&quot;
&quot;redhat-openshift-ocp-release-4.4-broken&quot;
&quot;redhat-openshift-ocp-release-4.7-broken&quot;
&quot;redhat-openshift-ocp-release-4.8-informing&quot;
&quot;redhat-openshift-okd-release-4.8-informing&quot;
&quot;redhat-openshift-okd-release-4.6-blocking&quot;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select the TestGrid dashboard for which you want to visualize the KPIs</span>
<span class="n">selected_dashboard</span> <span class="o">=</span> <span class="s1">&#39;&quot;redhat-assisted-installer&quot;&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<<<<<<< HEAD
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Available jobs under dashboard </span><span class="si">{selected_dashboard}</span><span class="s2">:&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
=======
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Available jobs under dashboard </span><span class="si">{</span><span class="n">selected_dashboard</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
>>>>>>> 7e7fb73... Update documentation
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">available_jobs_per_dashboard</span><span class="p">[</span><span class="n">selected_dashboard</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Available jobs under dashboard &quot;redhat-assisted-installer&quot;:

periodic-ci-openshift-release-master-nightly-4.7-e2e-metal-assisted
periodic-ci-openshift-release-master-nightly-4.7-e2e-metal-assisted-onprem
periodic-ci-openshift-release-master-nightly-4.6-e2e-metal-assisted
periodic-ci-openshift-release-master-nightly-4.8-e2e-metal-single-node-live-iso
periodic-ci-openshift-release-master-nightly-4.8-e2e-metal-assisted-ipv6
periodic-ci-openshift-release-master-nightly-4.8-e2e-metal-assisted
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select a job/grid from the dashboard</span>
<span class="n">selected_job</span> <span class="o">=</span> <span class="s2">&quot;periodic-ci-openshift-release-master-nightly-4.6-e2e-metal-assisted&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Dates available to fetch the KPI data from</span>
<span class="n">dates_available_for_kpifile</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>defaultdict(list,
            {&#39;avg_correlation&#39;: [&#39;2021-4-14&#39;,
              &#39;2021-4-16&#39;,
              &#39;2021-4-19&#39;,
              &#39;2021-4-29&#39;,
              &#39;2021-5-13&#39;,
              &#39;2021-5-14&#39;,
              &#39;2021-5-16&#39;,
              &#39;2021-5-18&#39;,
              &#39;2021-5-3&#39;,
              &#39;2021-5-5&#39;],
             &#39;blocked_timed_out&#39;: [&#39;2021-4-14&#39;,
              &#39;2021-4-16&#39;,
              &#39;2021-4-19&#39;,
              &#39;2021-4-27&#39;,
              &#39;2021-5-13&#39;,
              &#39;2021-5-14&#39;,
              &#39;2021-5-16&#39;,
              &#39;2021-5-18&#39;,
              &#39;2021-5-3&#39;,
              &#39;2021-5-5&#39;],
             &#39;build_pass_failure&#39;: [&#39;2021-4-14&#39;,
              &#39;2021-4-16&#39;,
              &#39;2021-4-19&#39;,
              &#39;2021-5-13&#39;,
              &#39;2021-5-14&#39;,
              &#39;2021-5-16&#39;,
              &#39;2021-5-18&#39;,
              &#39;2021-5-3&#39;,
              &#39;2021-5-5&#39;],
             &#39;correlation&#39;: [&#39;2021-4-14&#39;,
              &#39;2021-4-16&#39;,
              &#39;2021-4-19&#39;,
              &#39;2021-4-29&#39;,
              &#39;2021-5-13&#39;,
              &#39;2021-5-14&#39;,
              &#39;2021-5-16&#39;,
              &#39;2021-5-18&#39;,
              &#39;2021-5-3&#39;,
              &#39;2021-5-5&#39;],
             &#39;number_of_flakes&#39;: [&#39;2021-4-14&#39;,
              &#39;2021-4-16&#39;,
              &#39;2021-4-19&#39;,
              &#39;2021-4-27&#39;,
              &#39;2021-4-29&#39;,
              &#39;2021-5-13&#39;,
              &#39;2021-5-14&#39;,
              &#39;2021-5-16&#39;,
              &#39;2021-5-18&#39;,
              &#39;2021-5-3&#39;,
              &#39;2021-5-4&#39;,
              &#39;2021-5-5&#39;,
              &#39;2021-5-6&#39;],
             &#39;pct_fixed_each_ts&#39;: [&#39;2021-4-14&#39;,
              &#39;2021-4-16&#39;,
              &#39;2021-4-19&#39;,
              &#39;2021-4-27&#39;,
              &#39;2021-5-13&#39;,
              &#39;2021-5-14&#39;,
              &#39;2021-5-16&#39;,
              &#39;2021-5-18&#39;,
              &#39;2021-5-3&#39;,
              &#39;2021-5-5&#39;],
             &#39;persistent_failures&#39;: [&#39;2021-4-14&#39;,
              &#39;2021-4-16&#39;,
              &#39;2021-4-19&#39;,
              &#39;2021-4-27&#39;,
              &#39;2021-4-28&#39;,
              &#39;2021-4-29&#39;,
              &#39;2021-5-13&#39;,
              &#39;2021-5-14&#39;,
              &#39;2021-5-16&#39;,
              &#39;2021-5-18&#39;,
              &#39;2021-5-3&#39;,
              &#39;2021-5-4&#39;,
              &#39;2021-5-5&#39;],
             &#39;test_pass_failures&#39;: [&#39;2021-4-14&#39;,
              &#39;2021-4-16&#39;,
              &#39;2021-4-19&#39;,
              &#39;2021-4-27&#39;,
              &#39;2021-4-29&#39;,
              &#39;2021-5-13&#39;,
              &#39;2021-5-14&#39;,
              &#39;2021-5-16&#39;,
              &#39;2021-5-18&#39;,
              &#39;2021-5-3&#39;,
              &#39;2021-5-5&#39;],
             &#39;time_to_test&#39;: [&#39;2021-4-14&#39;,
              &#39;2021-4-16&#39;,
              &#39;2021-4-19&#39;,
              &#39;2021-4-27&#39;,
              &#39;2021-4-29&#39;,
              &#39;2021-5-13&#39;,
              &#39;2021-5-14&#39;,
              &#39;2021-5-16&#39;,
              &#39;2021-5-18&#39;,
              &#39;2021-5-3&#39;,
              &#39;2021-5-5&#39;]})
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_date</span> <span class="o">=</span> <span class="s2">&quot;2021-5-18&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="get-all-kpis-for-the-selected-dashboard-job-pair">
<<<<<<< HEAD
<h3>Get all KPIs for the selected dashboard, job pair<a class="headerlink" href="#get-all-kpis-for-the-selected-dashboard-job-pair" title="Permalink to this headline">¶</a></h3>
=======
<h3>Get all KPIs for the selected dashboard, job pair<a class="headerlink" href="#get-all-kpis-for-the-selected-dashboard-job-pair" title="Permalink to this headline">#</a></h3>
>>>>>>> 7e7fb73... Update documentation
<p>We will now fetch the available KPIs for the selected dashboard and job for a given date</p>
<p><strong>NOTE</strong> Some kpi files have no data for the given dashboard/job. e.g. for “redhat-openshift-ocp-release-4.2-informing”, “periodic-ci-openshift-release-master-ci-4.2-e2e-gcp”, blocked_time_out and test_pass_failure has no data (keys dont exist) and pct_fixed has all nan values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">get_kpi_data</span><span class="p">(</span>
    <span class="n">date</span><span class="o">=</span><span class="n">selected_date</span><span class="p">,</span>
    <span class="n">dashboard</span><span class="o">=</span><span class="n">selected_dashboard</span><span class="p">,</span>
    <span class="n">job</span><span class="o">=</span><span class="n">selected_job</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Neither &quot;job&quot; nor &quot;grid&quot; column found in metrics/avg_correlation/avg_correlation-2021-5-18.parquet. Maybe this df has a different schema. Appending it as-is, without filtering.
Neither &quot;job&quot; nor &quot;grid&quot; column found in metrics/correlation/correlation-2021-5-18.parquet. Maybe this df has a different schema. Appending it as-is, without filtering.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>average_number_of_correlated_failures</th>
      <th>tab</th>
      <th>grid</th>
      <th>test</th>
      <th>test_blocked</th>
      <th>test_timed_out</th>
      <th>test_duration</th>
      <th>build_failure</th>
      <th>build_passing</th>
      <th>...</th>
      <th>correlated_tests</th>
      <th>flake</th>
      <th>pct_fixed</th>
      <th>consec_fail_rate</th>
      <th>mean_fail_len</th>
      <th>mean_time_to_fix</th>
      <th>pass_to_fail_rate</th>
      <th>fail_to_pass_rate</th>
      <th>failure</th>
      <th>passing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2021-05-18 15:38:53.241300</td>
      <td>6131.752286</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2021-05-17 00:01:09.000000</td>
      <td>NaN</td>
      <td>"redhat-assisted-installer"</td>
      <td>periodic-ci-openshift-release-master-nightly-4...</td>
      <td>Overall</td>
      <td>False</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2021-05-15 13:18:27.000000</td>
      <td>NaN</td>
      <td>"redhat-assisted-installer"</td>
      <td>periodic-ci-openshift-release-master-nightly-4...</td>
      <td>Overall</td>
      <td>False</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2021-05-15 10:56:25.000000</td>
      <td>NaN</td>
      <td>"redhat-assisted-installer"</td>
      <td>periodic-ci-openshift-release-master-nightly-4...</td>
      <td>Overall</td>
      <td>False</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2021-05-15 02:35:35.000000</td>
      <td>NaN</td>
      <td>"redhat-assisted-installer"</td>
      <td>periodic-ci-openshift-release-master-nightly-4...</td>
      <td>Overall</td>
      <td>False</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 22 columns</p>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="kpis-for-the-selected-dashboard-job">
<<<<<<< HEAD
<h2>KPIs for the selected dashboard, job<a class="headerlink" href="#kpis-for-the-selected-dashboard-job" title="Permalink to this headline">¶</a></h2>
<p>Let us know try to visualize each of the KPIs for the selected dashboard, job</p>
<div class="section" id="percent-of-passing-and-failing-tests">
<h3>Percent of passing and failing tests<a class="headerlink" href="#percent-of-passing-and-failing-tests" title="Permalink to this headline">¶</a></h3>
=======
<h2>KPIs for the selected dashboard, job<a class="headerlink" href="#kpis-for-the-selected-dashboard-job" title="Permalink to this headline">#</a></h2>
<p>Let us know try to visualize each of the KPIs for the selected dashboard, job</p>
<div class="section" id="percent-of-passing-and-failing-tests">
<h3>Percent of passing and failing tests<a class="headerlink" href="#percent-of-passing-and-failing-tests" title="Permalink to this headline">#</a></h3>
>>>>>>> 7e7fb73... Update documentation
<p>The <code class="docutils literal notranslate"><span class="pre">test_pass_failures</span></code> <a class="reference internal" href="test_pass_failures.html"><span class="doc std std-doc">notebook</span></a> calculates the KPIs: “Number of Passing Tests”, “Number of Failing Tests”, “Percent of Failing Tests” and “Percent of Passing Tests”. These metrics can help track and measure the effectiveness and success of the CI testing process.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Dropping all the rows for which we have the `passing` and `failure` columns as NaN values</span>
<span class="n">tpf_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;passing&quot;</span><span class="p">,</span> <span class="s2">&quot;failure&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">tpf_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>average_number_of_correlated_failures</th>
      <th>tab</th>
      <th>grid</th>
      <th>test</th>
      <th>test_blocked</th>
      <th>test_timed_out</th>
      <th>test_duration</th>
      <th>build_failure</th>
      <th>build_passing</th>
      <th>...</th>
      <th>correlated_tests</th>
      <th>flake</th>
      <th>pct_fixed</th>
      <th>consec_fail_rate</th>
      <th>mean_fail_len</th>
      <th>mean_time_to_fix</th>
      <th>pass_to_fail_rate</th>
      <th>fail_to_pass_rate</th>
      <th>failure</th>
      <th>passing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2021-05-17 00:01:09</td>
      <td>NaN</td>
      <td>"redhat-assisted-installer"</td>
      <td>periodic-ci-openshift-release-master-nightly-4...</td>
      <td>Overall</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>111.816667</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2021-05-15 13:18:27</td>
      <td>NaN</td>
      <td>"redhat-assisted-installer"</td>
      <td>periodic-ci-openshift-release-master-nightly-4...</td>
      <td>Overall</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>92.966667</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2021-05-15 10:56:25</td>
      <td>NaN</td>
      <td>"redhat-assisted-installer"</td>
      <td>periodic-ci-openshift-release-master-nightly-4...</td>
      <td>Overall</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>111.916667</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2021-05-15 02:35:35</td>
      <td>NaN</td>
      <td>"redhat-assisted-installer"</td>
      <td>periodic-ci-openshift-release-master-nightly-4...</td>
      <td>Overall</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>97.883333</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2021-05-14 18:01:21</td>
      <td>NaN</td>
      <td>"redhat-assisted-installer"</td>
      <td>periodic-ci-openshift-release-master-nightly-4...</td>
      <td>Overall</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>109.166667</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>False</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 22 columns</p>
</div></div></div>
</div>
<p>There are 5334 total tests out of which we have True/False values for the <code class="docutils literal notranslate"><span class="pre">passing</span></code> and <code class="docutils literal notranslate"><span class="pre">failure</span></code> columns only for 1743 tests, the remaining are all NaN values. We will visualize the metrics only for these 1743 tests.</p>
<div class="section" id="number-of-test-passes">
<<<<<<< HEAD
<h4>Number of Test Passes<a class="headerlink" href="#number-of-test-passes" title="Permalink to this headline">¶</a></h4>
=======
<h4>Number of Test Passes<a class="headerlink" href="#number-of-test-passes" title="Permalink to this headline">#</a></h4>
>>>>>>> 7e7fb73... Update documentation
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lets see how many tests successfully passed</span>
<span class="n">tpf_df</span><span class="o">.</span><span class="n">passing</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True     1180
False      65
Name: passing, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_passes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">tpf_df</span><span class="o">.</span><span class="n">passing</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
<span class="n">test_passes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1180, 65]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="number-of-test-failures">
<<<<<<< HEAD
<h4>Number of Test Failures<a class="headerlink" href="#number-of-test-failures" title="Permalink to this headline">¶</a></h4>
=======
<h4>Number of Test Failures<a class="headerlink" href="#number-of-test-failures" title="Permalink to this headline">#</a></h4>
>>>>>>> 7e7fb73... Update documentation
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lets see how many tests failed</span>
<span class="n">tpf_df</span><span class="o">.</span><span class="n">failure</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False    1237
True        8
Name: failure, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_failures</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">tpf_df</span><span class="o">.</span><span class="n">failure</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
<span class="n">test_failures</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1237, 8]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="test-pass-and-test-failure-percentage">
<<<<<<< HEAD
<h4>Test Pass and Test Failure Percentage<a class="headerlink" href="#test-pass-and-test-failure-percentage" title="Permalink to this headline">¶</a></h4>
=======
<h4>Test Pass and Test Failure Percentage<a class="headerlink" href="#test-pass-and-test-failure-percentage" title="Permalink to this headline">#</a></h4>
>>>>>>> 7e7fb73... Update documentation
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s calculate the test pass/failure percentage</span>
<span class="n">test_passing_percentage</span> <span class="o">=</span> <span class="p">(</span><span class="n">test_passes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">test_passes</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test Pass percentage:&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">test_passing_percentage</span><span class="p">),</span> <span class="s2">&quot;%&quot;</span><span class="p">)</span>
<span class="n">test_failure_percentage</span> <span class="o">=</span> <span class="p">(</span><span class="n">test_failures</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">test_failures</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test Failure percentage:&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">test_failure_percentage</span><span class="p">),</span> <span class="s2">&quot;%&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Test Pass percentage: 94.77911646586345 %
Test Failure percentage: 0.642570281124498 %
</pre></div>
</div>
</div>
</div>
<p>Now, lets plot a bar plot for the same</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tpf_df_1</span> <span class="o">=</span> <span class="n">tpf_df</span><span class="p">[[</span><span class="s2">&quot;passing&quot;</span><span class="p">]]</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;variable&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">tpf_df_1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;# Test Passes&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Test Passes&quot;</span><span class="p">)</span>
<span class="n">with_hue</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">tpf_df_1</span><span class="p">)</span><span class="o">.</span><span class="n">variable</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/metrics_visualization_36_0.png" src="../../../../_images/metrics_visualization_36_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tpf_df_1</span> <span class="o">=</span> <span class="n">tpf_df</span><span class="p">[[</span><span class="s2">&quot;failure&quot;</span><span class="p">]]</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;variable&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">tpf_df_1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;# Test Failures&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Test Failures&quot;</span><span class="p">)</span>
<span class="n">with_hue</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">tpf_df_1</span><span class="p">)</span><span class="o">.</span><span class="n">variable</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/metrics_visualization_37_0.png" src="../../../../_images/metrics_visualization_37_0.png" />
</div>
</div>
<p>From the above graphs, we see that the total number of test passes that were successful was ~1200 and the number of tests that failed was about ~8. It is also important to note that if a test did not pass successfully, it does not neccessarily mean that it “failed”, its possible that the test could be attributed to other status values such as those mentioned in <a class="reference external" href="https://github.com/aicoe-aiops/ocp-ci-analysis/blob/master/docs/cell_labels_in_testgrid.md">https://github.com/aicoe-aiops/ocp-ci-analysis/blob/master/docs/cell_labels_in_testgrid.md</a>.
Now, lets see how the test passes and failures vary over time.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># graph data, test failures over time. 1 indicates &quot;True&quot; and 0 indicates &quot;False&quot;</span>
<span class="n">tpf_df</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="kc">False</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">True</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">rc</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">)})</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;timestamp&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;passing&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tpf_df</span><span class="p">,</span> <span class="n">ci</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Timestamp&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Test Passes (1/0)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Test passes over time&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/metrics_visualization_39_0.png" src="../../../../_images/metrics_visualization_39_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># graph data, test failures over time. 1 indicates &quot;True&quot; and 0 indicates &quot;False&quot;</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">rc</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">)})</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;timestamp&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;failure&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tpf_df</span><span class="p">,</span> <span class="n">ci</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Timestamp&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Test Failures (1/0)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Test failures over time&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/metrics_visualization_40_0.png" src="../../../../_images/metrics_visualization_40_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="persistent-failures">
<<<<<<< HEAD
<h3>Persistent Failures<a class="headerlink" href="#persistent-failures" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">persistent_failures_analysis</span></code> <a class="reference internal" href="persistent_failures_analysis.html"><span class="doc std std-doc">notebook</span></a> calculates the KPIs: “Consecutive Failure Rate”, “Pass to Fail Rate”, “Fail to Pass Rate” and “Mean Time to Fix”.</p>
<div class="section" id="consecutive-failure-rate">
<h4>Consecutive Failure Rate<a class="headerlink" href="#consecutive-failure-rate" title="Permalink to this headline">¶</a></h4>
=======
<h3>Persistent Failures<a class="headerlink" href="#persistent-failures" title="Permalink to this headline">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">persistent_failures_analysis</span></code> <a class="reference internal" href="persistent_failures_analysis.html"><span class="doc std std-doc">notebook</span></a> calculates the KPIs: “Consecutive Failure Rate”, “Pass to Fail Rate”, “Fail to Pass Rate” and “Mean Time to Fix”.</p>
<div class="section" id="consecutive-failure-rate">
<h4>Consecutive Failure Rate<a class="headerlink" href="#consecutive-failure-rate" title="Permalink to this headline">#</a></h4>
>>>>>>> 7e7fb73... Update documentation
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lets plot the consecutive failure rate for the tests</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">rc</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">5</span><span class="p">)})</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;consec_fail_rate&quot;</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
    <span class="n">order</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Tests&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Consecutive failure rate&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Consecutive failure rate grouped by tests&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/metrics_visualization_43_0.png" src="../../../../_images/metrics_visualization_43_0.png" />
</div>
</div>
<p>From the above graph, it seems like on that particular day i.e. “2021-5-18”, there were no consecutive failures among the tests.</p>
</div>
<div class="section" id="pass-to-fail-rate">
<<<<<<< HEAD
<h4>Pass to Fail Rate<a class="headerlink" href="#pass-to-fail-rate" title="Permalink to this headline">¶</a></h4>
=======
<h4>Pass to Fail Rate<a class="headerlink" href="#pass-to-fail-rate" title="Permalink to this headline">#</a></h4>
>>>>>>> 7e7fb73... Update documentation
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lets plot the rate of transition from test pass to fail</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">rc</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">5</span><span class="p">)})</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;pass_to_fail_rate&quot;</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
    <span class="n">order</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Tests&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Pass to fail rate&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Pass to fail rate grouped by tests&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/metrics_visualization_46_0.png" src="../../../../_images/metrics_visualization_46_0.png" />
</div>
</div>
</div>
<div class="section" id="fail-to-pass-rate">
<<<<<<< HEAD
<h4>Fail to Pass Rate<a class="headerlink" href="#fail-to-pass-rate" title="Permalink to this headline">¶</a></h4>
=======
<h4>Fail to Pass Rate<a class="headerlink" href="#fail-to-pass-rate" title="Permalink to this headline">#</a></h4>
>>>>>>> 7e7fb73... Update documentation
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lets plot the rate of transition from test fail to pass</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">rc</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">5</span><span class="p">)})</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;fail_to_pass_rate&quot;</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
    <span class="n">order</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Tests&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Fail to pass rate&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Fail to pass rate grouped by tests&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/metrics_visualization_48_0.png" src="../../../../_images/metrics_visualization_48_0.png" />
</div>
</div>
</div>
<div class="section" id="mean-time-to-fix">
<<<<<<< HEAD
<h4>Mean Time to Fix<a class="headerlink" href="#mean-time-to-fix" title="Permalink to this headline">¶</a></h4>
=======
<h4>Mean Time to Fix<a class="headerlink" href="#mean-time-to-fix" title="Permalink to this headline">#</a></h4>
>>>>>>> 7e7fb73... Update documentation
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lets plot the mean time to fix for each of the tests</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">rc</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">5</span><span class="p">)})</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;mean_time_to_fix&quot;</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
    <span class="n">order</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Tests&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Time to fix (minutes)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Mean time to fix (minutes)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/metrics_visualization_50_0.png" src="../../../../_images/metrics_visualization_50_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="time-to-test">
<<<<<<< HEAD
<h3>Time to Test<a class="headerlink" href="#time-to-test" title="Permalink to this headline">¶</a></h3>
=======
<h3>Time to Test<a class="headerlink" href="#time-to-test" title="Permalink to this headline">#</a></h3>
>>>>>>> 7e7fb73... Update documentation
<p>The <code class="docutils literal notranslate"><span class="pre">time_to_test</span></code> <a class="reference internal" href="time_to_test.html"><span class="doc std std-doc">notebook</span></a> calculates the KPI: “Average time to test”, which measures the time taken to run builds over time. Lets plot this test duration over time.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_kpis</span> <span class="o">=</span> <span class="s2">&quot;test_duration&quot;</span>

<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;timestamp&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">selected_kpis</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">ci</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Timestamp&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Test Duration (minutes)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Time taken to run builds over time&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/metrics_visualization_52_0.png" src="../../../../_images/metrics_visualization_52_0.png" />
</div>
</div>
<p>In the above graph, we see how the time taken to run a build changes over time and we notice when there are spikes or when irregular builds occur.</p>
<div class="section" id="average-time-to-test">
<<<<<<< HEAD
<h4>Average Time to Test<a class="headerlink" href="#average-time-to-test" title="Permalink to this headline">¶</a></h4>
=======
<h4>Average Time to Test<a class="headerlink" href="#average-time-to-test" title="Permalink to this headline">#</a></h4>
>>>>>>> 7e7fb73... Update documentation
<p>Let’s calculate the average time to test grouped by the different tests.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">average_time</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;tab&quot;</span><span class="p">,</span> <span class="s2">&quot;grid&quot;</span><span class="p">,</span> <span class="s2">&quot;test&quot;</span><span class="p">])[</span><span class="s2">&quot;test_duration&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">average_time</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>tab</th>
      <th>grid</th>
      <th>test</th>
      <th>test_duration</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>"redhat-assisted-installer"</td>
      <td>periodic-ci-openshift-release-master-nightly-4...</td>
      <td>Overall</td>
      <td>102.566667</td>
    </tr>
    <tr>
      <th>1</th>
      <td>"redhat-assisted-installer"</td>
      <td>periodic-ci-openshift-release-master-nightly-4...</td>
      <td>Pod</td>
      <td>88.066667</td>
    </tr>
    <tr>
      <th>2</th>
      <td>"redhat-assisted-installer"</td>
      <td>periodic-ci-openshift-release-master-nightly-4...</td>
      <td>openshift-tests.[k8s.io] Kubelet when scheduli...</td>
      <td>88.066667</td>
    </tr>
    <tr>
      <th>3</th>
      <td>"redhat-assisted-installer"</td>
      <td>periodic-ci-openshift-release-master-nightly-4...</td>
      <td>openshift-tests.[k8s.io] Lease lease API shoul...</td>
      <td>88.066667</td>
    </tr>
    <tr>
      <th>4</th>
      <td>"redhat-assisted-installer"</td>
      <td>periodic-ci-openshift-release-master-nightly-4...</td>
      <td>openshift-tests.[k8s.io] Probing container wit...</td>
      <td>88.066667</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Now, lets plot the average test duration grouped by tests.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">displot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;test_duration&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">average_time</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="n">multiple</span><span class="o">=</span><span class="s2">&quot;stack&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Average Test Duration (minutes)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Number of Tests&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Average Test Duration grouped by tests&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/metrics_visualization_58_0.png" src="../../../../_images/metrics_visualization_58_0.png" />
</div>
</div>
<p>From the above distribution plot, we see that for most of the tests took about ~88 minutes on an average to run the builds and there were a few which took a little longer, about ~100 minutes to run.</p>
</div>
</div>
<div class="section" id="percent-fixed">
<<<<<<< HEAD
<h3>Percent fixed<a class="headerlink" href="#percent-fixed" title="Permalink to this headline">¶</a></h3>
=======
<h3>Percent fixed<a class="headerlink" href="#percent-fixed" title="Permalink to this headline">#</a></h3>
>>>>>>> 7e7fb73... Update documentation
<p>The <code class="docutils literal notranslate"><span class="pre">pct_fixed_each_ts</span></code> <a class="reference internal" href="pct_fixed_each_ts.html"><span class="doc std std-doc">notebook</span></a> calculates the KPI: “Percent of tests fixed”, which measures the percent of tests that were failing and are now fixed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_kpis</span> <span class="o">=</span> <span class="s2">&quot;pct_fixed&quot;</span>

<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;timestamp&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">selected_kpis</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Timestamp&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Percent fixed&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Change in percent of fixed tests over time&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/metrics_visualization_61_0.png" src="../../../../_images/metrics_visualization_61_0.png" />
</div>
</div>
<p>From the above line graph, we see that the percent of fixed tests are quite low. This means that only a small percent of previously failing tests get fixed in each new run, which in turn implies that their CI process is likely not as efficient as it could be.</p>
</div>
<div class="section" id="correlated-failures">
<<<<<<< HEAD
<h3>Correlated failures<a class="headerlink" href="#correlated-failures" title="Permalink to this headline">¶</a></h3>
=======
<h3>Correlated failures<a class="headerlink" href="#correlated-failures" title="Permalink to this headline">#</a></h3>
>>>>>>> 7e7fb73... Update documentation
<p>The <code class="docutils literal notranslate"><span class="pre">correlated_failures</span></code> <a class="reference internal" href="correlated_failures.html"><span class="doc std std-doc">notebook</span></a> calculates the KPIs: “Correlated test failure sets per test” and “Average size of correlation set”, which measures the average number of failures for highly correlated tests i.e, sets of tests that most commonly fail together.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load data, KPI avg_correlation</span>

<span class="n">selected_filename</span> <span class="o">=</span> <span class="s2">&quot;avg_correlation&quot;</span>

<span class="n">metric_df_avg_corr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">,</span> <span class="s2">&quot;average_number_of_correlated_failures&quot;</span><span class="p">]</span>
<span class="p">)</span>

<span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dates_available_for_kpifile</span><span class="p">[</span><span class="n">selected_filename</span><span class="p">]:</span>
    <span class="n">metric_df_avg_corr</span> <span class="o">=</span> <span class="n">metric_df_avg_corr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">cc</span><span class="o">.</span><span class="n">read_from_ceph</span><span class="p">(</span>
            <span class="n">s3_path</span><span class="p">,</span>
<<<<<<< HEAD
            <span class="n">f</span><span class="s2">&quot;</span><span class="si">{selected_filename}</span><span class="s2">/</span><span class="si">{selected_filename}</span><span class="s2">-</span><span class="si">{d}</span><span class="s2">.parquet&quot;</span><span class="p">,</span>
=======
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">selected_filename</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">selected_filename</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s2">.parquet&quot;</span><span class="p">,</span>
>>>>>>> 7e7fb73... Update documentation
        <span class="p">)</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># graph data, KPI average number of correlated failures</span>

<span class="n">metric_name</span> <span class="o">=</span> <span class="s2">&quot;average_number_of_correlated_failures&quot;</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">rc</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">)})</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;timestamp&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">metric_name</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">metric_df_avg_corr</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Timestamp&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Average number of correlated failures&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Average number of correlated failures over time&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/metrics_visualization_65_0.png" src="../../../../_images/metrics_visualization_65_0.png" />
</div>
</div>
<p>From the above line graph, we see that the average number of correlated failures vary quite drastically over time, from being as high as 7000 and having no correlated failures at all.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># read data, KPI correlation</span>
<span class="n">selected_filename</span> <span class="o">=</span> <span class="s2">&quot;correlation&quot;</span>
<span class="n">selected_date</span> <span class="o">=</span> <span class="s2">&quot;2021-5-18&quot;</span>

<span class="n">metric_df_corr</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">read_from_ceph</span><span class="p">(</span>
    <span class="n">s3_path</span><span class="p">,</span>
<<<<<<< HEAD
    <span class="n">f</span><span class="s2">&quot;</span><span class="si">{selected_filename}</span><span class="s2">/</span><span class="si">{selected_filename}</span><span class="s2">-</span><span class="si">{selected_date}</span><span class="s2">.parquet&quot;</span><span class="p">,</span>
=======
    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">selected_filename</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">selected_filename</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">selected_date</span><span class="si">}</span><span class="s2">.parquet&quot;</span><span class="p">,</span>
>>>>>>> 7e7fb73... Update documentation
<span class="p">)</span>
<span class="n">metric_df_corr</span><span class="p">[</span><span class="s2">&quot;corr_count&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">metric_df_corr</span><span class="p">[</span><span class="s2">&quot;correlated_tests&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">len</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># graph data, KPI correlation</span>
<span class="n">metric_name</span> <span class="o">=</span> <span class="s2">&quot;corr_count&quot;</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">rc</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">)})</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">metric_name</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">metric_df_corr</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">metric_name</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">metric_df_corr</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;0.25&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Number of correlated failures&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Number of correlated failures per test&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/metrics_visualization_68_0.png" src="../../../../_images/metrics_visualization_68_0.png" />
</div>
</div>
<p>From the above box plot, we see that the mean number of correlated failures is about ~6000 and the maximum number of correlated failures observed on that day was about ~20000.</p>
</div>
<div class="section" id="blocked-timed-out">
<<<<<<< HEAD
<h3>Blocked, Timed out<a class="headerlink" href="#blocked-timed-out" title="Permalink to this headline">¶</a></h3>
=======
<h3>Blocked, Timed out<a class="headerlink" href="#blocked-timed-out" title="Permalink to this headline">#</a></h3>
>>>>>>> 7e7fb73... Update documentation
<p>The <code class="docutils literal notranslate"><span class="pre">blocked_timed_out</span></code> <a class="reference internal" href="blocked_timed_out.html"><span class="doc std std-doc">notebook</span></a> calculates the KPIs: “Number of tests blocked”, “Blocked tests percentage”, “Number of tests timed out”, and “Timed out tests percentage”.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lets see how many tests blocked out.</span>
<span class="n">df</span><span class="o">.</span><span class="n">test_blocked</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False    1245
Name: test_blocked, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lets see how many tests timed out.</span>
<span class="n">df</span><span class="o">.</span><span class="n">test_timed_out</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False    1245
Name: test_timed_out, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bto_df_1</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;test_blocked&quot;</span><span class="p">,</span> <span class="s2">&quot;test_timed_out&quot;</span><span class="p">]]</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;variable&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">bto_df_1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;# Test blocked/ timed out&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Number of tests blocked and timed out&quot;</span><span class="p">)</span>
<span class="n">with_hue</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">bto_df_1</span><span class="p">)</span><span class="o">.</span><span class="n">variable</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/metrics_visualization_73_0.png" src="../../../../_images/metrics_visualization_73_0.png" />
</div>
</div>
<p>Here, we can conclude that the test_blocked and test_timed_out values are either unavailable for the data or are “False”.</p>
</div>
<div class="section" id="build-pass-failure">
<<<<<<< HEAD
<h3>Build Pass Failure<a class="headerlink" href="#build-pass-failure" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">build_pass_failure</span></code> <a class="reference internal" href="build_pass_failure.html"><span class="doc std std-doc">notebook</span></a> calculates the KPIs: “Number of builds passed”, “Percentage of builds passed”, “Number of builds failed”, and “Percentage of builds failed”.</p>
<div class="section" id="number-of-builds-passed">
<h4>Number of builds passed<a class="headerlink" href="#number-of-builds-passed" title="Permalink to this headline">¶</a></h4>
=======
<h3>Build Pass Failure<a class="headerlink" href="#build-pass-failure" title="Permalink to this headline">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">build_pass_failure</span></code> <a class="reference internal" href="build_pass_failure.html"><span class="doc std std-doc">notebook</span></a> calculates the KPIs: “Number of builds passed”, “Percentage of builds passed”, “Number of builds failed”, and “Percentage of builds failed”.</p>
<div class="section" id="number-of-builds-passed">
<h4>Number of builds passed<a class="headerlink" href="#number-of-builds-passed" title="Permalink to this headline">#</a></h4>
>>>>>>> 7e7fb73... Update documentation
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lets see how many builds passed.</span>
<span class="n">df</span><span class="o">.</span><span class="n">build_passing</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True     13
False     2
Name: build_passing, dtype: int64
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="number-of-builds-failed">
<<<<<<< HEAD
<h4>Number of builds failed<a class="headerlink" href="#number-of-builds-failed" title="Permalink to this headline">¶</a></h4>
=======
<h4>Number of builds failed<a class="headerlink" href="#number-of-builds-failed" title="Permalink to this headline">#</a></h4>
>>>>>>> 7e7fb73... Update documentation
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lets see how many builds failed.</span>
<span class="n">df</span><span class="o">.</span><span class="n">build_failure</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False    13
True      2
Name: build_failure, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lets plot the consecutive failure rate for all tests</span>
<span class="n">bto_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;build_passing&quot;</span><span class="p">]]</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;variable&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">bto_df</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;# Builds passing/failing&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Number of builds passing/failing&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Number of builds passing/failing&#39;)
</pre></div>
</div>
<img alt="../../../../_images/metrics_visualization_80_1.png" src="../../../../_images/metrics_visualization_80_1.png" />
</div>
</div>
<p>For a given dashboard and job the build passing and failure are just the inverse of each other.</p>
</div>
</div>
<div class="section" id="number-of-flakes">
<<<<<<< HEAD
<h3>Number of flakes<a class="headerlink" href="#number-of-flakes" title="Permalink to this headline">¶</a></h3>
=======
<h3>Number of flakes<a class="headerlink" href="#number-of-flakes" title="Permalink to this headline">#</a></h3>
>>>>>>> 7e7fb73... Update documentation
<p>The <code class="docutils literal notranslate"><span class="pre">number_of_flakes</span></code> <a class="reference internal" href="number_of_flakes.html"><span class="doc std std-doc">notebook</span></a> calculates the KPIs: “Flaky tests” and “Flake severity”.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load data, KPI anumber_of_flakes</span>
<span class="n">selected_filename</span> <span class="o">=</span> <span class="s2">&quot;number_of_flakes&quot;</span>
<span class="n">selected_date</span> <span class="o">=</span> <span class="s2">&quot;2021-5-18&quot;</span>
<span class="n">selected_kpis</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;test_duration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;flake&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="c1"># read one of the kpis to plot the selected metrics objects from ceph</span>
<span class="n">metric_df</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">read_from_ceph</span><span class="p">(</span>
    <span class="n">s3_path</span><span class="p">,</span>
<<<<<<< HEAD
    <span class="n">f</span><span class="s2">&quot;</span><span class="si">{selected_filename}</span><span class="s2">/</span><span class="si">{selected_filename}</span><span class="s2">-</span><span class="si">{selected_date}</span><span class="s2">.parquet&quot;</span><span class="p">,</span>
=======
    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">selected_filename</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">selected_filename</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">selected_date</span><span class="si">}</span><span class="s2">.parquet&quot;</span><span class="p">,</span>
>>>>>>> 7e7fb73... Update documentation
<span class="p">)</span>
<span class="n">metric_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>tab</th>
      <th>grid</th>
      <th>test</th>
      <th>test_duration</th>
      <th>flake</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2021-05-17 00:01:09</td>
      <td>"redhat-assisted-installer"</td>
      <td>periodic-ci-openshift-release-master-nightly-4...</td>
      <td>Overall</td>
      <td>111.816667</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2021-05-15 13:18:27</td>
      <td>"redhat-assisted-installer"</td>
      <td>periodic-ci-openshift-release-master-nightly-4...</td>
      <td>Overall</td>
      <td>92.966667</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2021-05-15 10:56:25</td>
      <td>"redhat-assisted-installer"</td>
      <td>periodic-ci-openshift-release-master-nightly-4...</td>
      <td>Overall</td>
      <td>111.916667</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2021-05-15 02:35:35</td>
      <td>"redhat-assisted-installer"</td>
      <td>periodic-ci-openshift-release-master-nightly-4...</td>
      <td>Overall</td>
      <td>97.883333</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2021-05-14 18:01:21</td>
      <td>"redhat-assisted-installer"</td>
      <td>periodic-ci-openshift-release-master-nightly-4...</td>
      <td>Overall</td>
      <td>109.166667</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metric_df</span><span class="p">[[</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="s2">&quot;flake&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>test</th>
      <th>flake</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>42200517</td>
      <td>42200517</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>13897</td>
      <td>2</td>
    </tr>
    <tr>
      <th>top</th>
      <td>Overall</td>
      <td>False</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>55544</td>
      <td>41971275</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="section" id="flake-severity">
<<<<<<< HEAD
<h4>Flake Severity<a class="headerlink" href="#flake-severity" title="Permalink to this headline">¶</a></h4>
=======
<h4>Flake Severity<a class="headerlink" href="#flake-severity" title="Permalink to this headline">#</a></h4>
>>>>>>> 7e7fb73... Update documentation
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flake_severity</span> <span class="o">=</span> <span class="n">metric_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;test&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">flake</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">flake_severity</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;flake&quot;</span><span class="p">:</span> <span class="s2">&quot;flake_severity&quot;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flake_severity</span><span class="o">.</span><span class="n">flake_severity</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.000000    12520
0.000037       29
0.000037       26
0.000039       23
0.000037       21
            ...  
0.000103        1
0.154905        1
0.155513        1
0.001736        1
0.000628        1
Name: flake_severity, Length: 767, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">flake_severity</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Tests&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Flake Severity&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/metrics_visualization_88_0.png" src="../../../../_images/metrics_visualization_88_0.png" />
</div>
</div>
<p>From the above graph we can conclude that most of the tests have very low(~0) flake severity. One might look at this graph and assume that almost all of the tests have flake severity as 0. So, to get more clarity we have plotted another graph limiting the count to 50.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">flake_severity</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Tests&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Flake Severity&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/metrics_visualization_90_0.png" src="../../../../_images/metrics_visualization_90_0.png" />
</div>
</div>
<p>From the above graph we can see that there are other values of flake severity for some tests. However, it is a small bunch of tests that show a different set of flake severity.</p>
</div>
</div>
</div>
<div class="section" id="visualize-kpis-for-the-different-jobs-under-a-given-dashboard">
<<<<<<< HEAD
<h2>Visualize KPIs for the different jobs under a given dashboard<a class="headerlink" href="#visualize-kpis-for-the-different-jobs-under-a-given-dashboard" title="Permalink to this headline">¶</a></h2>
=======
<h2>Visualize KPIs for the different jobs under a given dashboard<a class="headerlink" href="#visualize-kpis-for-the-different-jobs-under-a-given-dashboard" title="Permalink to this headline">#</a></h2>
>>>>>>> 7e7fb73... Update documentation
<p>In this section, we’ll compare jobs within a dashboard on the basis of the selected KPIs. That is, given a dashboard (e.g. <code class="docutils literal notranslate"><span class="pre">&quot;redhat-openshift-ocp-release-4.6-informing&quot;</span></code>), we will plot the KPI values corresponding to the <code class="docutils literal notranslate"><span class="pre">Overall</span></code> row for each job (e.g. <code class="docutils literal notranslate"><span class="pre">periodic-ci-openshift-release-master-ci-4.6-e2e-aws</span></code>, <code class="docutils literal notranslate"><span class="pre">periodic-ci-openshift-release-master-ci-4.6-e2e-gcp</span></code>, etc.) under that dashboard. This would help us determine if our efforts should be focused on a particular platform or install config for OpenShift.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_filename</span> <span class="o">=</span> <span class="s2">&quot;number_of_flakes&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<<<<<<< HEAD
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Available dates to choose from for the file &quot;</span><span class="si">{selected_filename}</span><span class="s1">&quot;:&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
=======
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Available dates to choose from for the file &quot;</span><span class="si">{</span><span class="n">selected_filename</span><span class="si">}</span><span class="s1">&quot;:&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
>>>>>>> 7e7fb73... Update documentation
<span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dates_available_for_kpifile</span><span class="p">[</span><span class="n">selected_filename</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Available dates to choose from for the file &quot;number_of_flakes&quot;:

2021-4-14
2021-4-16
2021-4-19
2021-4-27
2021-4-29
2021-5-13
2021-5-14
2021-5-16
2021-5-18
2021-5-3
2021-5-4
2021-5-5
2021-5-6
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_date</span> <span class="o">=</span> <span class="s2">&quot;2021-5-18&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<<<<<<< HEAD
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Available KPIs to choose from for the file &quot;</span><span class="si">{selected_filename}</span><span class="s1">&quot;:&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
=======
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Available KPIs to choose from for the file &quot;</span><span class="si">{</span><span class="n">selected_filename</span><span class="si">}</span><span class="s1">&quot;:&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
>>>>>>> 7e7fb73... Update documentation
<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">kpis_in_kpifile</span><span class="p">[</span><span class="n">selected_filename</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Available KPIs to choose from for the file &quot;number_of_flakes&quot;:

test_duration
flake
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_kpis</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;test_duration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;flake&quot;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># read one of the kpis to plot the selected metrics objects from ceph</span>
<span class="n">metric_df</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">read_from_ceph</span><span class="p">(</span>
    <span class="n">s3_path</span><span class="p">,</span>
<<<<<<< HEAD
    <span class="n">f</span><span class="s2">&quot;</span><span class="si">{selected_filename}</span><span class="s2">/</span><span class="si">{selected_filename}</span><span class="s2">-</span><span class="si">{selected_date}</span><span class="s2">.parquet&quot;</span><span class="p">,</span>
=======
    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">selected_filename</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">selected_filename</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">selected_date</span><span class="si">}</span><span class="s2">.parquet&quot;</span><span class="p">,</span>
>>>>>>> 7e7fb73... Update documentation
<span class="p">)</span>
<span class="n">metric_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>tab</th>
      <th>grid</th>
      <th>test</th>
      <th>test_duration</th>
      <th>flake</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2021-05-17 00:01:09</td>
      <td>"redhat-assisted-installer"</td>
      <td>periodic-ci-openshift-release-master-nightly-4...</td>
      <td>Overall</td>
      <td>111.816667</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2021-05-15 13:18:27</td>
      <td>"redhat-assisted-installer"</td>
      <td>periodic-ci-openshift-release-master-nightly-4...</td>
      <td>Overall</td>
      <td>92.966667</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2021-05-15 10:56:25</td>
      <td>"redhat-assisted-installer"</td>
      <td>periodic-ci-openshift-release-master-nightly-4...</td>
      <td>Overall</td>
      <td>111.916667</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2021-05-15 02:35:35</td>
      <td>"redhat-assisted-installer"</td>
      <td>periodic-ci-openshift-release-master-nightly-4...</td>
      <td>Overall</td>
      <td>97.883333</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2021-05-14 18:01:21</td>
      <td>"redhat-assisted-installer"</td>
      <td>periodic-ci-openshift-release-master-nightly-4...</td>
      <td>Overall</td>
      <td>109.166667</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tabs</span> <span class="o">=</span> <span class="n">metric_df</span><span class="p">[</span><span class="s2">&quot;tab&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Available dashboard tabs to choose from:&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tabs</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Available dashboard tabs to choose from:

&quot;redhat-assisted-installer&quot;
&quot;redhat-openshift-informing&quot;
&quot;redhat-openshift-ocp-release-4.1-blocking&quot;
&quot;redhat-openshift-ocp-release-4.1-informing&quot;
&quot;redhat-openshift-ocp-release-4.2-blocking&quot;
&quot;redhat-openshift-ocp-release-4.2-informing&quot;
&quot;redhat-openshift-ocp-release-4.3-blocking&quot;
&quot;redhat-openshift-ocp-release-4.3-broken&quot;
&quot;redhat-openshift-ocp-release-4.3-informing&quot;
&quot;redhat-openshift-ocp-release-4.4-blocking&quot;
&quot;redhat-openshift-ocp-release-4.4-broken&quot;
&quot;redhat-openshift-ocp-release-4.4-informing&quot;
&quot;redhat-openshift-ocp-release-4.5-blocking&quot;
&quot;redhat-openshift-ocp-release-4.5-broken&quot;
&quot;redhat-openshift-ocp-release-4.5-informing&quot;
&quot;redhat-openshift-ocp-release-4.6-blocking&quot;
&quot;redhat-openshift-ocp-release-4.6-broken&quot;
&quot;redhat-openshift-ocp-release-4.6-informing&quot;
&quot;redhat-openshift-ocp-release-4.7-blocking&quot;
&quot;redhat-openshift-ocp-release-4.7-broken&quot;
&quot;redhat-openshift-ocp-release-4.7-informing&quot;
&quot;redhat-openshift-ocp-release-4.8-blocking&quot;
&quot;redhat-openshift-ocp-release-4.8-broken&quot;
&quot;redhat-openshift-ocp-release-4.8-informing&quot;
&quot;redhat-openshift-ocp-release-4.9-blocking&quot;
&quot;redhat-openshift-ocp-release-4.9-informing&quot;
&quot;redhat-openshift-okd-release-4.3-informing&quot;
&quot;redhat-openshift-okd-release-4.4-informing&quot;
&quot;redhat-openshift-okd-release-4.5-blocking&quot;
&quot;redhat-openshift-okd-release-4.5-informing&quot;
&quot;redhat-openshift-okd-release-4.6-blocking&quot;
&quot;redhat-openshift-okd-release-4.6-informing&quot;
&quot;redhat-openshift-okd-release-4.7-blocking&quot;
&quot;redhat-openshift-okd-release-4.7-informing&quot;
&quot;redhat-openshift-okd-release-4.8-blocking&quot;
&quot;redhat-openshift-okd-release-4.8-informing&quot;
&quot;redhat-openshift-okd-release-4.9-informing&quot;
&quot;redhat-openshift-presubmit-master-gcp&quot;
&quot;redhat-osd&quot;
&quot;redhat-single-node&quot;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select the dashboard and test</span>
<span class="n">selected_tab</span> <span class="o">=</span> <span class="s1">&#39;&quot;redhat-assisted-installer&quot;&#39;</span>
<span class="n">selected_test</span> <span class="o">=</span> <span class="s2">&quot;Overall&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Here we are plotting the test duration metric over time for the different jobs within a given dashboard tab</span>
<span class="n">plot_grids</span><span class="p">(</span>
    <span class="n">selected_tab</span><span class="p">,</span>
    <span class="n">selected_test</span><span class="p">,</span>
    <span class="n">metric_df</span><span class="p">,</span>
    <span class="n">selected_kpis</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="s2">&quot;Timestamp&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Test Duration (minutes)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Test Duration Over Time (by jobs)&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/metrics_visualization_101_0.png" src="../../../../_images/metrics_visualization_101_0.png" />
<img alt="../../../../_images/metrics_visualization_101_1.png" src="../../../../_images/metrics_visualization_101_1.png" />
<img alt="../../../../_images/metrics_visualization_101_2.png" src="../../../../_images/metrics_visualization_101_2.png" />
<img alt="../../../../_images/metrics_visualization_101_3.png" src="../../../../_images/metrics_visualization_101_3.png" />
<img alt="../../../../_images/metrics_visualization_101_4.png" src="../../../../_images/metrics_visualization_101_4.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Here we are plotting the flakes over time for the different jobs within a given dashboard tab</span>
<span class="n">plot_grids</span><span class="p">(</span>
    <span class="n">selected_tab</span><span class="p">,</span>
    <span class="n">selected_test</span><span class="p">,</span>
    <span class="n">metric_df</span><span class="p">,</span>
    <span class="n">selected_kpis</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
    <span class="s2">&quot;Timestamp&quot;</span><span class="p">,</span>
    <span class="s2">&quot;1(true) or 0(false)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Flakes Over Time&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/metrics_visualization_102_0.png" src="../../../../_images/metrics_visualization_102_0.png" />
<img alt="../../../../_images/metrics_visualization_102_1.png" src="../../../../_images/metrics_visualization_102_1.png" />
<img alt="../../../../_images/metrics_visualization_102_2.png" src="../../../../_images/metrics_visualization_102_2.png" />
<img alt="../../../../_images/metrics_visualization_102_3.png" src="../../../../_images/metrics_visualization_102_3.png" />
<img alt="../../../../_images/metrics_visualization_102_4.png" src="../../../../_images/metrics_visualization_102_4.png" />
</div>
</div>
</div>
<div class="section" id="visualize-the-kpis-for-different-tests-under-a-given-job">
<<<<<<< HEAD
<h2>Visualize the KPIs for different tests under a given job<a class="headerlink" href="#visualize-the-kpis-for-different-tests-under-a-given-job" title="Permalink to this headline">¶</a></h2>
=======
<h2>Visualize the KPIs for different tests under a given job<a class="headerlink" href="#visualize-the-kpis-for-different-tests-under-a-given-job" title="Permalink to this headline">#</a></h2>
>>>>>>> 7e7fb73... Update documentation
<p>In this section, we’ll compare the various tests that are run in a job, on the basis of the selected KPIs. That is, given a job (e.g. <code class="docutils literal notranslate"><span class="pre">periodic-ci-openshift-release-master-ci-4.6-e2e-gcp</span></code>), we will plot the KPI values corresponding to each test (e.g. <code class="docutils literal notranslate"><span class="pre">operator</span> <span class="pre">conditions</span> <span class="pre">cluster-autoscaler</span></code>, <code class="docutils literal notranslate"><span class="pre">operator</span> <span class="pre">conditions</span> <span class="pre">cloud-credential</span></code>, etc.) under that job. This would help us determine if our efforts should be focused on a particular set of components in OpenShift.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># For a given dashboard, identify all the jobs (grids)</span>
<span class="n">selected_tab</span> <span class="o">=</span> <span class="s1">&#39;&quot;redhat-openshift-ocp-release-4.1-informing&quot;&#39;</span>

<span class="n">grids</span> <span class="o">=</span> <span class="n">metric_df</span><span class="p">[</span><span class="n">metric_df</span><span class="p">[</span><span class="s2">&quot;tab&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">selected_tab</span><span class="p">][</span><span class="s2">&quot;grid&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Available grids to choose from:&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">grids</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Available grids to choose from:

release-openshift-origin-installer-e2e-aws-upgrade-4.1-stable-to-4.1-nightly
release-openshift-origin-installer-e2e-aws-upgrade-rollback-4.1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select the job(grid)</span>
<span class="n">selected_grid</span> <span class="o">=</span> <span class="s2">&quot;release-openshift-origin-installer-e2e-aws-upgrade-rollback-4.1&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">metric_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;tab&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">selected_tab</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;grid&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">selected_grid</span><span class="p">)]</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>tab</th>
      <th>grid</th>
      <th>test</th>
      <th>test_duration</th>
      <th>flake</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3125771</th>
      <td>2021-05-18 01:10:50</td>
      <td>"redhat-openshift-ocp-release-4.1-informing"</td>
      <td>release-openshift-origin-installer-e2e-aws-upg...</td>
      <td>Overall</td>
      <td>60.966667</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3125772</th>
      <td>2021-05-17 01:09:14</td>
      <td>"redhat-openshift-ocp-release-4.1-informing"</td>
      <td>release-openshift-origin-installer-e2e-aws-upg...</td>
      <td>Overall</td>
      <td>123.000000</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3125773</th>
      <td>2021-05-16 01:07:37</td>
      <td>"redhat-openshift-ocp-release-4.1-informing"</td>
      <td>release-openshift-origin-installer-e2e-aws-upg...</td>
      <td>Overall</td>
      <td>58.450000</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3125774</th>
      <td>2021-05-15 01:06:27</td>
      <td>"redhat-openshift-ocp-release-4.1-informing"</td>
      <td>release-openshift-origin-installer-e2e-aws-upg...</td>
      <td>Overall</td>
      <td>61.450000</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3125775</th>
      <td>2021-05-14 01:05:25</td>
      <td>"redhat-openshift-ocp-release-4.1-informing"</td>
      <td>release-openshift-origin-installer-e2e-aws-upg...</td>
      <td>Overall</td>
      <td>81.633333</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Count of flakes identified in the tests for a particular grid(job) in a given TestGrid dashboard tab</span>
<span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;flake&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Flakes (bool)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Count&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Number of Flakes&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/metrics_visualization_107_0.png" src="../../../../_images/metrics_visualization_107_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Here we are plotting the test duration metric over time for different tests within a given dashboard tab</span>
<span class="n">plot_tests</span><span class="p">(</span>
    <span class="n">selected_tab</span><span class="p">,</span>
    <span class="n">selected_grid</span><span class="p">,</span>
    <span class="n">df</span><span class="p">,</span>
    <span class="n">selected_kpis</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="s2">&quot;Timestamp&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Test Duration (minutes)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Test Duration Over Time (by tests)&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/metrics_visualization_108_0.png" src="../../../../_images/metrics_visualization_108_0.png" />
</div>
</div>
<p><strong>NOTE</strong> The values for “test_duration” are only available for “Overall” hence the above graph shows only one lineplot with variation and rest all are overlapping at 80.</p>
</div>
<div class="section" id="conclusion">
<<<<<<< HEAD
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h2>
=======
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">#</a></h2>
>>>>>>> 7e7fb73... Update documentation
<p>In this notebook, we have tried to read the collected metrics from ceph and use visualization libraries like <code class="docutils literal notranslate"><span class="pre">seaborn</span></code> to explore our data. We have tried different granularities here:</p>
<ul class="simple">
<li><p>Dashboard, Job pair: Here we visualize all the available KPIs for a selected dashboard, job pair.</p></li>
<li><p>Job level : Here we choose a dashboard and analyze across various jobs for “Overall” test.</p></li>
<li><p>Test level : Here we choose a dashboard and job and then visualize the metrics for various tests.</p></li>
</ul>
<p>For future work, we could look into other collected metrics and explore more visualization tools for further detailed analyses.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks/data-sources/TestGrid/metrics"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
<<<<<<< HEAD
        
        <div class='prev-next-bottom'>
            

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By AIOps<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>
=======
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By AIOps<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>
>>>>>>> 7e7fb73... Update documentation


      </div>
    </div>
  
<<<<<<< HEAD
  <script src="../../../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
=======
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


>>>>>>> 7e7fb73... Update documentation
  </body>
</html>